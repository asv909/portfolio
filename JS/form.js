$(document).ready(function(){var c="#inquiry";var A="#subj";var v="#msg";var n="#asp";var x="#error";var a="#reset";var w="#callback";var z=["#mail","#tphone"];var d=["#e-mail","#call"];var t=["#time","#attn"];var j="#phoneNum";var o="#areaCode";var p="#refresh";var y=$(ColSel);var g=c+" :text";var f=z[0]+" span";var u=z[1]+" span";var l=t[0]+","+t[1];$(g)[0].focus();ErrSum=$(x);ErrSum.hide();$(a).hide();var b=$(l);var e=$(d[0]);var s=$(d[1]);var q=$(f);var r=$(u);b.hide(function(){y.eqHeights()});$(g+",textarea").click(function(){ErrSum.hide();y.eqHeights()});e.click(function(){q.toggleClass("red",true).toggleClass("grey",false);r.toggleClass("red",false).toggleClass("grey",true);b.slideUp(function(){y.eqHeights()})});s.click(function(){q.toggleClass("red",false).toggleClass("grey",true);r.toggleClass("red",true).toggleClass("grey",false);b.slideDown(function(){y.eqHeights()})});$(p).click(function(){$(this).load("asp/image_req.php");return false});$(a).click(function(){$(w).show();$(a).hide();ErrSum.hide();$(p).load("asp/image_req.php");$(n+","+v).val("");$(A+" :first").attr("selected","selected");return false});var k="Пожалуйста, обязательно ";var i="Пожалуйста, правильно ";var B=k+"укажите ";var m=i+"укажите ";var h=' <span class="error">красной пунктирной рамкой</span>. Пожалуйста, введите корректные данные и вновь нажмите кнопку <span class="blue">"Отправить"</span>';$(c).validate({rules:{surname:{required:true,rangelength:[2,25]},name:{required:true,rangelength:[2,20]},pname:{rangelength:[2,15]},firm:{required:true,rangelength:[2,50]},email:{required:"#e-mail:checked",email:true,maxlength:50},areaCode:{required:"#call:checked",digits:true,rangelength:function(E){var F=$(j).val();var D=0;var C=F.length;if(C==0){D=[3,5]}else{C=10-C;if(C<3||C>5){D=[3,5]}else{D=[C,C]}}return D}},phoneNum:{digits:true,required:"#call:checked",rangelength:function(E){var F=$(o).val();var D=0;var C=F.length;if(C==0){D=[5,7]}else{C=10-C;if(C<5||C>7){D=[5,7]}else{D=[C,C]}}return D}},addNum:{digits:true,maxlength:3},msg:{required:true,rangelength:[30,3000]},asp:{required:true,digits:true,rangelength:[5,5],remote:"asp/check.php"}},messages:{surname:{required:B+"Вашу Фамилию!",rangelength:jQuery.format(m+"Вашу Фамилию!<br/>Фамилия должна занимать от {0} до {1} знакомест.")},name:{required:B+"Ваше Имя!",rangelength:jQuery.format(m+"Ваше Имя!<br/>Имя должно занимать от {0} до {1} знакомест.")},pname:{rangelength:jQuery.format(m+"Ваше Отчество!<br/>Отчество должно занимать от {0} до {1} знакомест.")},firm:{required:B+"название Вашего предприятия!",rangelength:jQuery.format(m+"название Вашего предприятия!<br/>Название должно занимать от {0} до {1} знакомест.")},email:{required:B+"Ваш адрес электронной почты!",maxlength:jQuery.format(m+"Ваш e-mail адрес!<br/>E-mail должен занимать не более {0} знакомест."),email:"Пожалуйста, введите корректный e-mail адрес!"},areaCode:{required:B+"телефонный код Вашего региона!",rangelength:jQuery.format(m+"код Вашего региона!<br/>Код должен содержать от {0} до {1} цифр (вместе с номером должно быть ровно 10 цифр)."),digits:m+"код Вашего региона!<br/>Код должен содержать только цифры."},phoneNum:{required:B+"Ваш номер телефона!",rangelength:jQuery.format(m+"Ваш номер телефона!<br/>Номер должен содержать от {0} до {1} цифр (вместе с кодом должно быть ровно 10 цифр."),digits:m+"Ваш номер телефона!<br/>Номер должен содержать только цифры."},addNum:{maxlength:jQuery.format(m+"добавочный № Вашего телефона!<br/>Добавочный № может содержать до {0} цифр максимум."),digits:m+"доб.№ Вашего телефона!<br/>Добавочный № должен содержать только цифры."},msg:{required:k+"изложите суть Вашего запроса!",rangelength:jQuery.format(i+"наберите Ваше сообщение!<br/>Сообщение должно содержать от {0} до {1} символов.")},asp:{required:k+"введите код!",digits:i+"введите код!<br/>Код должен содержать только цифры!",rangelength:jQuery.format(i+"введите код!<br/>Специальный код - это комбинация из {0} цифр."),remote:m+"комбинацию цифр!<br/>Указанная Вами комбинация цифр не совпадает с изображённым на картинке специальным кодом"}},errorPlacement:function(C,D){C.insertAfter(D.parent());y.eqHeights()},invalidHandler:function(E,C){var F=C.numberOfInvalids();if(F){var D="";if(F==1){D='Обнаружена <span class="red">1 ошибка</span>. Поле с ошибкой выделено'+h}else{if(F>1&&F<5){D='Обнаружено <span class="red">'+F+" ошибки</span>. Поля с ошибками выделены"+h}else{D='Обнаружено <span class="red">'+F+" ошибок</span>. Поля с ошибками выделены"+h}}$(x).html(D).show();y.eqHeights()}},submitHandler:function(E){var C=$(c).find(":submit");var D=C.val();C.attr("disabled",true);C.val("Идет отправка...");var F=$(c).serialize();$.post("inquiry?event=add",F,function(H,G){if(G=="success"){if(H.send==0){var J="В отправленных данных обнаружены <span class='red'>ошибки ("+H.errCount+")</span>:<br/>";var I=H.errMessage;$(x).html(J+I).show()}else{$(x).html("<span style='color:green;'>Данные успешно отправлены! Мы ответим или позвоним Вам в самое ближайшее время!</span>").show();$(w).hide();$(a).show()}y.eqHeights()}else{$(x).html("<span class='red'>Данные не обработаны из-за ошибки на сервере. Повторите попытку позже или сообщите об ошибке администратору сайта: web@eurotrade-et.ru</span>").show();y.eqHeights()}},"json");C.val(D);C.attr("disabled",false);return false}})});